<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <!-- CRITICAL: Preconnect to origins -->
    <link rel="preconnect" href="https://hfirnolwhesjkxshidxo.supabase.co" crossorigin />
    
    <!-- CRITICAL: Preload hero image for faster LCP -->
    <link rel="preload" as="image" href="https://i.ibb.co/20BWhH7J/Messenger-creation-9-D5326-FA-08-DE-471-A-BAB1-6-E385-C838-D90-2-optimized.webp" fetchpriority="high" />
    
    <!-- DNS prefetch for later-loaded resources -->
    <link rel="dns-prefetch" href="https://www.googletagmanager.com" />
    <link rel="dns-prefetch" href="https://i.ibb.co" />
    
    <title>Poppa's Wooden Creations - Premium Handcrafted Wooden Toys from Whangarei, NZ</title>
    <meta name="description" content="Discover premium handcrafted wooden toys made from native NZ timbers in Whangarei. Eco-friendly, safe, and built to last. Shop unique Kiwi-made toys today." />
    
    <!-- Extended Critical CSS - Inline more styles for faster rendering -->
    <style>
      /* Critical base styles */
      *, *::before, *::after { 
        margin: 0; 
        padding: 0; 
        box-sizing: border-box; 
      }
      
      html { 
        -webkit-text-size-adjust: 100%;
        -webkit-font-smoothing: antialiased;
      }
      
      body { 
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
        line-height: 1.6;
        color: #1f2937;
        background: #ffffff;
        font-display: swap;
      }
      
      /* CRITICAL: Force immediate text rendering */
      * {
        font-display: swap !important;
      }
      
      /* Header critical styles */
      header {
        position: sticky;
        top: 0;
        z-index: 30;
        background: #ffffff;
        box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
      }
      
      /* Hero section critical styles */
      .hero-section { 
        min-height: 60vh; 
        display: flex; 
        align-items: center;
        justify-content: center;
        padding: 2rem 1rem;
      }
      
      .hero-content {
        max-width: 1200px;
        width: 100%;
        text-align: center;
      }
      
      h1 { 
        font-size: clamp(2rem, 5vw, 3rem);
        line-height: 1.2; 
        margin-bottom: 1rem;
        font-weight: 700;
        color: #111827;
        font-display: swap !important;
      }
      
      .hero-text { 
        font-size: clamp(1rem, 2vw, 1.25rem);
        color: #4b5563; 
        line-height: 1.75; 
        max-width: 42rem;
        margin: 0 auto 2rem;
        font-display: swap !important;
      }
      
      p {
        font-display: swap !important;
      }
      
      /* Button critical styles */
      .btn-primary {
        display: inline-block;
        padding: 0.75rem 1.5rem;
        background: #d97706;
        color: #ffffff;
        text-decoration: none;
        border-radius: 0.5rem;
        font-weight: 600;
        transition: background 0.2s;
      }
      
      .btn-primary:hover {
        background: #b45309;
      }
      
      /* Category grid critical styles */
      .category-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 1.5rem;
        padding: 2rem 1rem;
        max-width: 1200px;
        margin: 0 auto;
      }
      
      /* Image loading optimization */
      img {
        max-width: 100%;
        height: auto;
        display: block;
        content-visibility: auto;
      }
      
      /* Prevent layout shift */
      .aspect-ratio-box {
        position: relative;
        width: 100%;
        padding-bottom: 56.25%; /* 16:9 aspect ratio */
      }
      
      .aspect-ratio-box img {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        object-fit: cover;
      }
    </style>
    
    <!-- Module preload for faster script execution -->
    <link rel="modulepreload" href="/src/main.tsx" />
  </head>
  <body>
    <!-- GTM noscript -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NQG3DNXR"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    
    <div id="root"></div>
    
    <!-- Load main script -->
    <script type="module" src="/src/main.tsx"></script>
    
    <!-- Super-deferred GTM - Only load after user interaction or 3 seconds -->
    <script>
      // Aggressive GTM deferral
      function loadGTM() {
        if (window.gtmLoaded) return;
        window.gtmLoaded = true;
        
        (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-NQG3DNXR');
      }
      
      // Load GTM after user interaction or 3 seconds
      var loadTriggered = false;
      
      function triggerGTM() {
        if (loadTriggered) return;
        loadTriggered = true;
        if (document.readyState === 'complete') {
          setTimeout(loadGTM, 1000);
        } else {
          window.addEventListener('load', function() {
            setTimeout(loadGTM, 1000);
          });
        }
      }
      
      // Trigger on user interaction
      ['scroll', 'mousemove', 'touchstart', 'click'].forEach(function(event) {
        window.addEventListener(event, triggerGTM, { once: true, passive: true });
      });
      
      // Or after 3 seconds as fallback
      setTimeout(triggerGTM, 3000);
    </script>
  </body>
</html>
